<html>
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
  <title>Mozilla SpeedTest Runner</title>
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/speedtests.js"></script>
</head>
<body>
<div id="main">
<p>
SpeedTests go!
</p>
</div>
<script>
$(document).ready(function() {
  var searchParams = SpeedTests.getSearchParams();
  if (!searchParams.testUrl) {
    $('#main p').text('No testUrl parameter given.');
  } else if (searchParams.test) {
    var s = decodeURIComponent(searchParams.testUrl);
    var testName = s.slice(0, s.lastIndexOf('/')).slice(0, s.lastIndexOf("#"));
    $('#main p').text('TEST submitting results for ' + testName + '...');
    SpeedTests.nextTest(testName);
  } else {
    var s = decodeURIComponent(searchParams.testUrl);
    var hashStart = s.lastIndexOf("#");
    var hash = "";
    if (hashStart != -1) {
      hash = s.slice(hashStart);
      s = s.slice(0, hashStart);
    }
    window.open(s + document.location.search + hash, 'testWindow',
                'resizable=no,status=no,top=0,left=0,height=768,width=1024,menubar=no,toolbar=no,location=no,personalbar=no');
  }
});
</script>
</body>
</html>
